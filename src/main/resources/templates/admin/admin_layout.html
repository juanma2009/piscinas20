<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.utraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style th:replace="admin/shared/style"></style>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/style.css}">

    <!-- CSS DataTables + Responsive -->
    <link rel="stylesheet"
          href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">
    <link rel="stylesheet"
          href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">

    <!-- JS DataTables + Responsive -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>

    <style>
        body {
            margin: 0; /* Elimina el margen predeterminado del cuerpo */
            padding: 0; /* Elimina el relleno predeterminado del cuerpo */

        }

        .content-wrapper {
            position: relative;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            height: 110vh; /* Ajusta la altura al 100% del viewport */
            overflow: hidden; /* Oculta el desplazamiento vertical */
        }
        /* ============================
    1) ESTILOS GENERALES
    ============================ */
        html, body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;   /* Evita scroll horizontal */
            overflow-y: auto;     /* Permite desplazamiento vertical */
            height: auto;
        }

        /* Asegurar que el content-wrapper tenga scroll si lo necesita */
        .content-wrapper {
            min-height: 100vh;
            overflow-y: auto !important;
            overflow-x: hidden;
        }


        /* ============================
           2) OCULTAR SIDEBAR EN M칍VILES
           Incluye Xiaomi 12T Pro en adelante
           ============================ */
        @media (max-width: 768px) {
            .main-sidebar,
            .left-side,
            .sidebar {
                display: none !important;
            }

            .content-wrapper {
                margin-left: 0 !important;
            }

            html, body {
                overflow-y: auto !important;
                height: auto !important;
            }
        }


        /* ============================
           3) AJUSTE PARA M칍VILES PEQUE칌OS
           (Xiaomi, POCO, Redmi, iPhone SE, etc.)
           ============================ */
        @media (max-width: 480px) {
            html, body {
                overflow-y: auto !important;
                height: auto !important;
            }

            .content-wrapper {
                padding-bottom: 40px; /* Evita cortes con el teclado */
            }
        }
        /* Botones del listado (Galer칤a / Clientes / Nuevo Cliente / Mostrar Filtros)
     adaptados a m칩vil */
        @media (max-width: 768px) {

            /* El grupo de botones se convierte en un flex que envuelve */
            .btn-group.btn-group-toggle {
                display: flex !important;
                flex-wrap: wrap !important;
                width: 100% !important;
                justify-content: center; /* opcional: centra los botones */
            }

            /* Cada bot칩n ocupa aproximadamente la mitad del ancho */
            .btn-group.btn-group-toggle .btn {
                flex: 1 1 100%;
                margin-bottom: 8px;
                margin-right: 4px;
                margin-left: 4px;
                text-align: center;
            }
        }
        /* ===========================
           ESTILOS ESPECIALES PARA M칍VILES
           =========================== */

        /* Todo contenido debe poder hacer scroll */
        @media (max-width: 768px) {

            /* Habilitar scroll general */
            html, body {
                overflow-y: auto !important;
                overflow-x: hidden !important;
                height: auto !important;
            }

            /* Ocultar el men칰 lateral en m칩viles */
            .main-sidebar,
            .left-side,
            .sidebar {
                display: none !important;
            }

            /* El contenido ocupa toda la pantalla */
            .content-wrapper {
                margin-left: 0 !important;
                min-height: 100vh !important;
                overflow-y: auto !important;
            }

            /* Ajuste de los botones: que se adapten a la pantalla */
            .btn-group .btn,
            .btn,
            a.btn {
                width: 100%;
                margin-bottom: 8px;
                display: block;
                text-align: center;
            }

            /* Filtros (formulario de b칰squeda) m치s grandes en m칩vil */
            #formBusqueda {
                max-height: 1200px !important;     /* espacio suficiente */
                overflow-y: auto !important;       /* scroll interno si se supera la altura */
            }

            /* Evitar que el grid de im치genes se corte */
            #photo-container {
                max-height: none !important;
                overflow-y: visible !important;
            }
        }

        /* Ajustes SOLO para pantallas m칩viles */
        @media (max-width: 768px) {
            /* Ocultar el bot칩n de 'Clientes' en pantallas peque침as */
            body #tablaClientes .btn-group .btn:nth-child(3),
            body #tablaClientes .btn-group .btn:nth-child(2) {
                display: none !important; /* Oculta el bot칩n de 'Clientes' */
            }

            /* Mostrar solo los botones de 'Pedidos' y 'Galer칤a' */
            body #tablaClientes .btn-group .btn:nth-child(1)
             {
                display: inline-block !important; /* Asegura que se vean los botones de 'Pedidos' y 'Galer칤a' */
            }
        }

        /* Ajustes generales para los botones */
        body #tablaClientes .acciones-container .btn-group {
            display: flex !important;
            flex-direction: row !important;  /* Los botones deben estar en una l칤nea horizontal */
            justify-content: center !important;
            gap: 5px !important;
            flex-wrap: nowrap !important;  /* Evita que los botones se apilen */
        }

        /* Ajustes para el tama침o y espaciado de los botones */
        body #tablaClientes .acciones-container .btn-group .btn {
            padding: 6px 12px !important;  /* Ajusta el tama침o del padding */
            font-size: 14px !important;    /* Ajusta el tama침o de la fuente */
            min-width: auto !important;    /* Evita que el bot칩n se colapse */
        }

        /* Ajustes para pantallas peque침as (m칩viles) */
        @media (max-width: 768px) {
            /* Asegura que los botones est칠n en una sola l칤nea horizontal */
            body #tablaClientes .acciones-container .btn-group {
                flex-direction: row !important;  /* En pantallas peque침as, los botones deben estar en una fila */
                justify-content: center !important;
                gap: 5px !important; /* Espacio entre botones */
            }

            body #tablaClientes .acciones-container .btn-group .btn {
                width: auto !important;  /* Ajusta el tama침o de los botones */
                padding: 4px 8px !important;  /* Ajusta el padding */
                font-size: 12px !important;   /* Tama침o de fuente m치s peque침o para m칩viles */
            }

            /* Reducir el tama침o de las filas de la tabla */
            body #tablaClientes thead th,
            body #tablaClientes tbody td {
                padding: 6px 4px !important;  /* Reducir padding en pantallas m칩viles */
                font-size: 12px !important;   /* Ajustar tama침o de texto */
            }
        }

      /*tabls datatable



    </style>
</head>
<script>
    $(document).on("click", "a.ajax-link", function (e) {
        e.preventDefault(); // Cancela el cambio de p치gina completo

        const url = $(this).attr("href");

        // Mostrar un peque침o spinner en el 치rea de contenido
        $("#mainContent").html(
            '<div class="text-center p-5"><i class="fa fa-spinner fa-spin fa-3x"></i><br>Cargando...</div>'
        );

        // Cargar solo el fragmento del contenido
        $("#mainContent").load(url + " #contentFragment", function(response, status, xhr) {
            if (status === "error") {
                $("#mainContent").html("<div class='alert alert-danger'>Error al cargar esta secci칩n.</div>");
            }
        });
    });

    $(document).ready(function () {
        iniciarTablaClientes();
    });

    function iniciarTablaClientes() {
        const $tabla = $('#tablaClientes');

        if ($tabla.length === 0) return;

        if ($.fn.DataTable.isDataTable($tabla)) {
            $tabla.DataTable().clear().destroy();
        }

        const esMovil = window.matchMedia("(max-width: 768px)").matches;

        if (!esMovil) {
            // ============================
            // 游둰 CONFIGURACI칍N DE ESCRITORIO
            // ============================
            $tabla.DataTable({
                language: {
                    lengthMenu: "Mostrar _MENU_ registros por p치gina",
                    zeroRecords: "No se encontraron resultados",
                    info: "Mostrando p치gina _PAGE_ de _PAGES_",
                    infoEmpty: "No hay registros disponibles",
                    infoFiltered: "(filtrado de _MAX_ registros totales)",
                    search: "Buscar:",
                    paginate: {
                        first: "Primero",
                        last: "칔ltimo",
                        next: "Siguiente",
                        previous: "Anterior"
                    }
                },
                paging: true,
                searching: true,
                ordering: true,
                lengthMenu: [5, 10, 15, 25],
                pageLength: 5,
                scrollY: "50vh",
                scrollCollapse: true,
                responsive: true,
                fixedHeader: true,
                scrollX: false
            });
        } else {
            // ============================
            // 游님 CONFIGURACI칍N PARA M칍VILES
            // ============================
            $tabla.DataTable({
                language: {
                    url: "//cdn.datatables.net/plug-ins/1.13.8/i18n/es-ES.json"
                },
                paging: true,
                pageLength: 5,
                searching: true,
                ordering: false,
                responsive: true,
                scrollX: true,
                scrollY: "45vh",
                scrollCollapse: true,
                columnDefs: [
                    { targets: "col-hide-mobile", visible: false } // 游댠 oculta estas columnas internamente en DT
                ]
            });
        }
    }






</script>

<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">
    <!-- Header -->
    <div th:replace="admin/shared/header"></div>

    <!-- Sidebar -->
    <div th:replace="admin/shared/left_side"></div>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <div class="container-fluid">
           <!-- Capa de superposici칩n semi-transparente -->
            <div id="mainContent" class="content">
                <div id="contentFragment" layout:fragment="content">
                    <!-- Aqu칤 va tu contenido -->
                </div>
            </div>
        </div>
    </div>
    <!-- /.content-wrapper -->

    <!-- Footer Scripts -->
    <div layout:fragment="script">
        <!-- Aqu칤 puedes agregar scripts adicionales -->
    </div>

    <!-- Additional Scripts -->
    <div th:replace="admin/shared/file_script"></div>
</div>

<!-- Bootstrap JS and dependencies -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
</body>
</html>
